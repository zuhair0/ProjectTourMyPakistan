@page "/addviewpointimage/{vpid}"
@using ClassLibraryDAL
@using ClassLibraryModel
<h3>AddViewPointImage</h3>
<EditForm Model="viewPointImage" OnSubmit="SaveViewPointImage">
    <label>View point Image URL:</label>
    <input type="text" @bind-value="viewPointImage.VP_image_url" required />
    <label>View point Image detail_eng:</label>
    <input type="text" @bind-value="viewPointImage.Vp_detail_Eng" required />
    <button type="submit">Save View Point Image</button>
</EditForm>
<p>@msg</p>

<table class="table table-bordered">
    <thead>
        <tr>
            <th>View point id</th>
            <th>View point image URL</th>
            <th>View point image Details</th>
        </tr>
    </thead>
    @foreach (var item in viewPointImagesList)
    {
        <tr>
            <td>@item.VP_id</td>
            <td>@item.VP_image_url</td>
            <td>@item.Vp_detail_Eng</td>
            <td>
                <button @onclick="(()=>DeleteViewpointImage(item.VP_id))">
                    Delete
                </button>
            </td>
        </tr>
    }
</table>
@code {
    [Parameter]
    public string? vpid { get; set; }
    private string? msg { get; set; }
    private List<ViewPointImageModel> viewPointImagesList = new List<ViewPointImageModel>();
    private ViewPointImageModel viewPointImage = new ViewPointImageModel();
    private void SaveViewPointImage(){
        viewPointImage.VP_id = int.Parse(vpid);
        int i = ViewPointImageDAL.SaveViewPointImage(viewPointImage);
        if(i==1){
            msg = "Add View Point Image Succefully";
            GetViewPointImage();
        }
        else{
            msg = "Error while saving View Point Image";
        }
    }
    protected override void OnInitialized()
    {
        GetViewPointImage();
    }
    private void GetViewPointImage(){
        viewPointImagesList = ViewPointImageDAL.GetViewpointsImage();
    }
    private void DeleteViewpointImage(int id){
        int i = ViewPointImageDAL.DeleteViewPointImage(id);
        if(i==1){
            msg = "Deleted succesfully";
            GetViewPointImage();
        }
        else{
            msg = "Error while deleting";
        }
    }
}
